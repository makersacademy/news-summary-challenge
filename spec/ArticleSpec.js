(function() {
  console.log("Testing Article model: ");

  (function() {
    console.log(" it gets an id");
    var articleModelOne = new ArticleModel();
    var articleModelTwo = new ArticleModel();
    assert.isTrue(articleModelOne.id() === 0);
    assert.isTrue(articleModelTwo.id() === 1);
  })();

  (function() {
    console.log(" it can be instantiated with a headline");
    var articleModel = new ArticleModel("Al Gore: 'I tried my best' but Trump can't be educated on climate change");
    assert.isTrue(articleModel.headline === "Al Gore: 'I tried my best' but Trump can't be educated on climate change");
  })();

  (function() {
    console.log(" it can be instantiated with a url for the full story");
    var articleModel = new ArticleModel("Al Gore: 'I tried my best'", 'www.guardian.co.uk/awesome_story');
    assert.isTrue(articleModel.url === 'www.guardian.co.uk/awesome_story');
  })();

  (function() {
    console.log(" it finds an image in the story body if there isn't one in the main section");
    var articleModel = new ArticleModel("Al Gore: 'I tried my best'", 'www.guardian.co.uk/awesome_story', `<p>This Royal Ballet triple bill, which had its first night on Monday, saw two new works introduced to the repertoire. Both are well made and danced, but raise serious questions about the company and the vision of its directors.</p> <p>The opening piece is Twyla Tharpâ€™s <strong>The Illustrated â€œFarewellâ€</strong>. Set to Haydnâ€™s Symphony No 45 (known as the â€œFarewellâ€), itâ€™s an expansion of Tharpâ€™s abstract work <a href='https://www.twylatharp.org/works/time-goes'><em>As Time Goes By</em></a>, choreographed in 1973 to part of the same symphony. Most of the new material is danced by Steven McRae and Sarah Lamb, and they hit every beat, delivering Tharpâ€™s jazzy shoulder rolls, foxy footwork and rubato phrasing as if to the manner born. The ensemble, led by Mayara Magri and Joseph Sissens, are fluency itself.</p> <aside class='element element-rich-link element--thumbnail'> <p> <span>Related: </span><a href='https://www.theguardian.com/stage/2017/nov/02/twyla-tharp-interview-royal-ballet-opera-house'>Dance legend Twyla Tharp on truculent men, selling hot dogs and her idol Agatha Christie</a> </p> </aside>  <p>If the piece is formally rigorous, itâ€™s also dated, over-elaborate and a bit camp. Even as I admired the dancing, I didnâ€™t believe a bar of it, and Chester Weinbergâ€™s costumes donâ€™t help. Men in micro-shorts with twee little belts, darting yearning glances at women in mid-calf chiffons. Why, in 2017, is neo-classical dance still so fixated on such a coy, infantilising paradigm?</p> <p>There is an increasingly acute issue surrounding womenâ€™s roles in ballet. In the last few seasons the Royal Ballet stage has seen record numbers of female characters brutalised and killed. Emily, Mary Jane, and Little Dot eviscerated in <a href='https://www.theguardian.com/stage/2014/may/18/serenade-sweet-violets-dgv-royal-ballet-review'><em>Sweet Violets</em></a>, Justine hanged and Elizabeth murdered in <a href='https://www.theguardian.com/stage/2016/may/08/frankenstein-royal-ballet-review-liam-scarlett'><em>Frankenstein</em></a>, Stephanie raped and Mary shot in <a href='https://www.theguardian.com/stage/2017/may/01/mayerling-review-royal-ballet-royal-opera-house-london'><em>Mayerling</em></a>, the girl raped in <a href='http://www.roh.org.uk/news/macmillans-the-invitation-how-dancers-revive-a-challenging-historic-ballet'><em>The Invitation</em></a>, the youngest sister hanged in <a href='http://www.roh.org.uk/productions/las-hermanas-by-kenneth-macmillan'><em>Las Hermanas</em></a>, and the woman raped and murdered in <a href='https://www.theguardian.com/stage/2017/oct/29/the-judas-tree-kenneth-macmillan-royal-ballet-observer-review'><em>The Judas Tree</em></a>. Consider this body-count alongside the number of recent abstract works in which women are split, splayed and otherwise manhandled, and certain embedded attitudes reveal themselves.</p>  <figure class='element element-image' data-media-id='41a9a8187b86f37a2baa142a8c2f41cc8c6496ee'> <img src='https://media.guim.co.uk/41a9a8187b86f37a2baa142a8c2f41cc8c6496ee/0_0_5046_3029/1000.jpg' alt='A â€˜coy, infantilising paradigm?â€™ Steven McRae and Sarah Lamb in The Illustrated â€œFarewellâ€ by Twyla Tharp.' width='1000' height='600' class='gu-image' /> <figcaption> <span class='element-image__caption'>A â€˜coy, infantilising paradigm?â€™: Steven McRae and Sarah Lamb in The Illustrated â€œFarewellâ€ by Twyla Tharp.</span> <span class='element-image__credit'>Photograph: Tristram Kenton for the Observer</span> </figcaption> </figure>  <p>None of these works, in which female characters are defined by their passivity and victimhood, was created by a woman. Elsewhere in the British arts establishment, the question of female agency in performance is a live topic. At Covent Garden, itâ€™s not even a conversation. Which is why, presumably, the Royal commissioned Arthur Pitaâ€™s <a href='http://www.roh.org.uk/productions/the-wind-by-arthur-pita'><strong>The Wind</strong></a>, a ballet whose pivotal event is another violent rape.</p> <p>Pita is a terrific choreographer, and in many respects this is a terrific ballet. Based on Dorothy Scarboroughâ€™s 1925 novel of the same name, <em>The Wind</em> tells the story of Letty Mason (Natalia Osipova), who arrives at a remote pioneer settlement in Texas. Appalled by the desolation of the place, she is driven to distraction by the unceasing wind. To survive, she marries a cowboy (Thiago Soares), and in his absence is preyed upon by a brutal cattle buyer (Thomas Whitehead), whom she shoots dead.</p>  <figure class='element element-image element--showcase' data-media-id='f33877481c319c21e4f04618ea27c906fd9dfb7a'> <img src='https://media.guim.co.uk/f33877481c319c21e4f04618ea27c906fd9dfb7a/0_0_4949_2880/1000.jpg' alt='Natalia Osipova and Thiago Soares in The Wind.' width='1000' height='582' class='gu-image' /> <figcaption> <span class='element-image__caption'>Natalia Osipova and Thiago Soares in The Wind.</span> <span class='element-image__credit'>Photograph: Tristram Kenton for the Observer</span> </figcaption> </figure>  <p>Frank Moonâ€™s score is atmospheric, and Jeremy Herbertâ€™s set, which incorporates wind machines resembling antiquated farm machinery, is suitably bleak. Yann Seabraâ€™s costumes, meanwhile (gunbelts and duster coats for the men, big hats and weather-bleached ruffles for the women) are splendidly evocative. Pita deploys a low-slung choreographic style whose narrow range echoes the grim constraints of the location, and our first sight of the full cast, silhouetted against a parchment sky, is a real <em>coup de thÃ©Ã¢tre</em>. Soaresâ€™s taciturn cowboy is subtly drawn, Whitehead is terrifying, and Osipova is mesmerising as Letty, stamping out neurotic little bourrÃ©es on pointe as her hold on reality unravels.</p> <aside class='element element-rich-link element--thumbnail'> <p> <span>Related: </span><a href='https://www.theguardian.com/stage/2017/oct/29/the-judas-tree-kenneth-macmillan-royal-ballet-observer-review'>The Judas Tree review â€“ genius marred by misogyny</a> </p> </aside>  <p>Despite these performances, the ballet feels rushed and foreshortened, as if thereâ€™s a central chapter missing. Then thereâ€™s the rape, which in a kind of ghastly continuity follows hard on the heels of the rape in <em>The Judas Tree</em>, which closed just five days earlier. Not that this is Pitaâ€™s fault. No subject should be off-limits to an artist, rape included, and Pita tells his story as he sees it. Itâ€™s the Royalâ€™s commissioning process that needs examining. If the company is sincere in its desire to attract new audiences, it needs to better understand the times in which it lives. Perhaps this isnâ€™t the moment in history to present yet another ballet in which a woman is the object of sexual violence simply because she is a woman.</p> <ul> <li><a href='http://www.roh.org.uk/mixed-programmes/the-illustrated-farewell-the-wind-untouchable'>The Royal Balletâ€™s triple bill is in rep at the Royal Opera House, London, until until 17 November</a></li> </ul>`, "");
    assert.isTrue(articleModel.imageUrl() === 'https://media.guim.co.uk/41a9a8187b86f37a2baa142a8c2f41cc8c6496ee/0_0_5046_3029/1000.jpg');
  })();

  (function() {
    console.log(" it takes the first three pars of the story body as a summary");
    var articleModel = new ArticleModel("Al Gore: 'I tried my best'", 'www.guardian.co.uk/awesome_story', `<p>It is my 25th birthday this weekend, which means I am officially allowed to use the phrase â€œquarterlife crisisâ€. I am infinitely less wise than I thought I would be by now, but, because I am halfway through my third decade and adulthood is slapping me in the face like a wet fish, Iâ€™m well placed to share 25 things I have learned.</p> <p><strong>1. </strong>Your physical and mental health, and that of those closest to you, is all that really matters. Everything else is just background scenery, irrelevant decor that adorns your life.<br /></p> <p><strong>2. </strong>The UK isnâ€™t the worse place in the world to live. Even with the populist politics, the consistently terrible Saturday night TV and the national obsession with a pallid, tasteless, leafâ€‘based drink, it is alright, really.</p> <p><strong>3. </strong>There is no shame in talking about your feelings out loud. British people are bad at this: ignore them. Get therapy, call a mate, speak up.</p> <p><strong>4. </strong>Excellent friends will see you through dark times. Thank them, get drunk with them, party with them before they get married and have kids.</p> <p><strong>5. </strong>It is fine to jettison anyone who doesnâ€™t bring out the best in you.</p> <p><strong>6. </strong>Forgiveness isnâ€™t weakness.</p> <p><strong>7. </strong>Diets are pointless.</p> <p><strong>8. </strong>Reality TV will save your soul during the bleakest of times.</p> <p><strong>9. </strong>Grief is not something you can seal up inside you and smooth over. You will learn to build around it, to carry on, but sometimes grief will mow you down and plough straight through you. This is OK.</p> <p><strong>10. </strong>London is a decent city in which to wile away your youth: it has thousands of bars and this thing politicians call â€œopportunityâ€, so it is fun at times.</p> <p><strong>11. </strong>Forget the property thing. Financial stability, your own space and the freedom to paint your walls anything other than magnolia are overrated.</p> <p><strong>12. </strong>Keeping yourself organised is now less of a chore and more a way of living that I have come to realise is actually conducive to success.</p> <p><strong>13. </strong>A Hotmail email address is no longer acceptable.</p> <p><strong>14. </strong>Filing systems are useful. Post-it notes are not evil. Calendars were created for a reason.</p> <p><strong>15. </strong>Storing all your passwords on one spreadsheet is a recipe for hours and hours of wasted time.</p> <p><strong>16. </strong>Money comes and goes.</p> <p><strong>17. </strong>The more you earn, the more you spend on boring purchases that make your life a little bit easier and a touch more mundane: Â£20 on floral coasters; Â£1,000 in a no-access, fiveâ€‘year Isa. Living.</p> <p><strong>18.</strong> Adulthood is basically transitioning from spending Â£500 in Topshop to blowing Â£1,000 in Ikea on a credit card.</p> <p><strong>19.</strong> Talking to strangers wonâ€™t kill you. Most people are actually OK â€“ unless they are estate agents.</p> <p><strong>20.</strong> Bad/random/drunken sex still happens, just less frequently than it used to, because you donâ€™t have the time and you are over the drama.</p> <p><strong>21.</strong> If you are going to spend most of your life working, it helps to find something you love. Perhaps it wonâ€™t happen in your 20s, but getting passionate about something makes the world shine that little bit brighter.</p> <p><strong>22. </strong>Extended periods of travel are nearly always a good idea. Travel changes your world outlook, melts prejudices and leaves you with better pub chat, so go.</p> <p><strong>23. </strong>The days of eating fried, doughy carbs with wild abandon all winter and then strutting around half-naked come summer are, unfortunately, over.</p> <p><strong>24. </strong>Exercise â€¦ is â€¦ good â€¦ because it makes you look <em>and</em> feel â€¦ good? You should really keep it up.</p> <p><strong>25.</strong> Your parents are just two deeply flawed human beings who may or may not have led strange and interesting lives before they met and had you. They have issues and a whole heap of weird stuff going on in their heads, just like you. Love them anyway.</p> <p><a href="https://twitter.com/GeorginaLawton"><em>@GeorginaLawton</em></a></p>"`);

    var expectedText = `<p>It is my 25th birthday this weekend, which means I am officially allowed to use the phrase â€œquarterlife crisisâ€. I am infinitely less wise than I thought I would be by now, but, because I am halfway through my third decade and adulthood is slapping me in the face like a wet fish, Iâ€™m well placed to share 25 things I have learned.</p><p><strong>1. </strong>Your physical and mental health, and that of those closest to you, is all that really matters. Everything else is just background scenery, irrelevant decor that adorns your life.<br></p><p><strong>2. </strong>The UK isnâ€™t the worse place in the world to live. Even with the populist politics, the consistently terrible Saturday night TV and the national obsession with a pallid, tasteless, leafâ€‘based drink, it is alright, really.</p>`;

    assert.isTrue(articleModel.summary() === expectedText);
  })();

})();
